digraph G {
  rankdir = LR;
  node [shape = box];

  {
    rank = min;
    SETUP;
  }

  {
    rank = same;
    PENDING;
    PLUGIN_FAILURE;
  }

  {
    rank = max;
    SUCCESS;
    SETUP_ABORTED;
    PAYMENT_FAILURE_ABORTED;
    PLUGIN_FAILURE_ABORTED;
  }


  SETUP [shape = diamond];
  SETUP -> SETUP;
  SETUP -> PENDING;

  SETUP -> PLUGIN_FAILURE;
  SETUP -> SETUP_ABORTED

  PENDING -> PENDING;
  PENDING -> PLUGIN_FAILURE;

  PLUGIN_FAILURE -> PENDING;
  PLUGIN_FAILURE -> PLUGIN_FAILURE;

  edge [color = green];
  SETUP -> SUCCESS;
  PENDING -> SUCCESS;
  PLUGIN_FAILURE -> SUCCESS;

  edge [color = red];
  SETUP -> PAYMENT_FAILURE_ABORTED;
  PENDING -> PAYMENT_FAILURE_ABORTED;
  PLUGIN_FAILURE -> PLUGIN_FAILURE_ABORTED;
}
