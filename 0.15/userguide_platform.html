<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Kill Bill platform guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="book">
<div id="header">
<h1>Kill Bill platform guide</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#components-overview">Overview</a>
<ul class="sectlevel2">
<li><a href="#_kill_bill_platform">Kill Bill Platform</a></li>
<li><a href="#_documentation">Documentation</a></li>
<li><a href="#_where_to_start">Where To Start?</a></li>
</ul>
</li>
<li><a href="#components-features">Kill Bill Platform Features</a>
<ul class="sectlevel2">
<li><a href="#_multi_tenancy">Multi-Tenancy</a></li>
<li><a href="#_rbac">RBAC</a></li>
<li><a href="#_plugins">Plugins</a>
<ul class="sectlevel3">
<li><a href="#_overview">Overview</a></li>
<li><a href="#_lifecycle_and_layout_internals">Lifecycle and Layout Internals</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#deployment">Deployment</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">Overview</a></li>
<li><a href="#deployment-jetty">Installation in Jetty</a>
<ul class="sectlevel3">
<li><a href="#_download_the_jetty_container">Download the Jetty container</a></li>
<li><a href="#_deploy_kill_bill_in_jetty">Deploy Kill Bill in Jetty</a></li>
<li><a href="#_enable_ssl">Enable SSL</a></li>
</ul>
</li>
<li><a href="#deployment-tomcat">Installation in Tomcat</a>
<ul class="sectlevel3">
<li><a href="#_download_the_tomcat_container">Download the Tomcat container</a></li>
<li><a href="#_deploy_kill_bill_in_tomcat">Deploy Kill Bill in Tomcat</a></li>
</ul>
</li>
<li><a href="#deployment-glassfish">Installation in Glassfish</a>
<ul class="sectlevel3">
<li><a href="#_download_the_glassfish_container">Download the GlassFish container</a></li>
<li><a href="#_deploy_kill_bill_in_glassfish">Deploy Kill Bill in GlassFish</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#_system_properties">System properties</a>
<ul class="sectlevel3">
<li><a href="#configuration-overview">Overview</a></li>
<li><a href="#_system_properties_2">System Properties</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="components-overview">Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kill_bill_platform">Kill Bill Platform</h3>
<div class="paragraph">
<p>At its core, Kill Bill offers a flexible platform on which applications that require a high level of integrity, audit traces, and robustness can be developed. Currently there are two kind of applications that have been developed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://killbill.io/subscription-billing">Billing Systems</a> to manage recurring/usage based subscriptions</p>
</li>
<li>
<p><a href="http://killbill.io/payments-platform/">Payment systems</a> that integrate with various payment gateways, payment processors, fraud detection systems, &#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>Billing System</strong> relies on the <strong>Payment System</strong> to make payments but the <strong>Payment System</strong> also offers raw payment apis and therefore can also be run as a standalone application.</p>
</div>
<div class="paragraph">
<p>Some of the features of the Kill Bill platform include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Core Foundations</p>
<div class="ulist">
<ul>
<li>
<p>A plugin framework where custom plugins can be added to modify the behavior of the system, and or interact with third party systems,</p>
</li>
<li>
<p>A robust persistent event bus, that is used both internally and externally (events are visible to plugins)</p>
</li>
<li>
<p>An auditing framework that keeps track of all the changes that occurred (who?, when?, what?)</p>
</li>
<li>
<p>Authentication and RBAC support</p>
</li>
</ul>
</div>
</li>
<li>
<p>Core services (account management, invoicing, entitlement, dunning, &#8230;&#8203;) which are built and packaged as independent jars, each of which with its own api; those core services post a well defined set of events on the persistent bus which are then consumed by other core services or plugins.</p>
</li>
<li>
<p>Plugins</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="https://docs.google.com/drawings/d/1OCYn6GTrmEbJi9daT8L9xPCgwp7n5FidTWH0nHpCYqE/pub?w=960&amp;h=480" alt="pub?w=960&amp;amp;h=480">
</div>
</div>
<div class="paragraph">
<p>Contrary to most billing solutions, Kill Bill is <strong>not</strong> a batch oriented system, but instead, it is driven by events occurring in the system (for example, the creation of a new subscription will create a new event that the invoicing core service will process and as result a new invoice may be created along with a new event, which the payment core service will then process, &#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>Kill Bill is traditionally packaged as a war and is therefore executed within a web container (for example Tomcat). It offers <a href="http://killbill.io/api/">REST APIs</a> to manage all the state associated to accounts, subscriptions, invoices, payments, &#8230;&#8203; It also provides lower level (java) APIs and can therefore be embedded as a library within a (java) user application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="paragraph">
<p>Our documentation is targeted for different types of audience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kill Bill Visitors: technical or non-technical folks interested to know more about what Kill Bill is about.</p>
</li>
<li>
<p>Kill Bill Users: technical folks that are interested to evaluate the solution or are ready to deploy it.</p>
</li>
<li>
<p>Kill Bill Developers: technical folks that are interested to contribute to the open-source project (often to enhance the platform to suit their own specific needs).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the <strong>Kill Bill Visitors</strong>, we provide an overview of the product on our <a href="http://killbill.io">main web site</a>, and also <a href="http://killbill.io/features">some more details about the features</a>.</p>
</div>
<div class="paragraph">
<p>For the <strong>Kill Bill Users</strong>,  we provide a set of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://killbill.io/userguide/platform-userguide">user guides</a>,</p>
</li>
<li>
<p><a href="http://killbill.io/tutorials/">tutorials</a>,</p>
</li>
<li>
<p><a href="https://www.youtube.com/channel/UChXICgGipKvJbtzKfM1SNoQ">screencasts</a>,</p>
</li>
<li>
<p>In addition to that, we also provide documentation for each specific plugin in the github plugin repository (via a <code>Readme</code> file). An example of such documentation can be seen for the <a href="https://github.com/killbill/killbill-avatax-plugin">Avatax plugin</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The user guides are split into 3 different pages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://killbill.io/userguide/platform-userguide">Platform User Guide</a>, that is, <strong>this very page</strong>, which focuses on generic information about the Kill Bill platform (plugin overview, deployment and configuration),</p>
</li>
<li>
<p><a href="http://killbill.io/userguide/payments-userguide/">Payment System User Guide</a>: Focuses on various payment methods, payment flows, &#8230;&#8203;</p>
</li>
<li>
<p><a href="http://killbill.io/userguide/subscriptions-userguide/">Billing System User Guide</a>: Focuses on all the non payment aspects for the billing system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the <strong>Kill Bill Developers</strong>, we also provide additional pages on our <a href="https://github.com/killbill/killbill/wiki">github wiki</a>.</p>
</div>
<div class="paragraph">
<p>Also, don&#8217;t forget to check our <a href="http://killbill.io/blog/">blog</a>, which has interesting articles about some of Kill Bill internals, use cases, &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p><strong>Most of our documentation is hosted in a <a href="https://github.com/killbill/killbill-docs">GitHub repository</a>, so please either submit a PR when obvious things are missing or wrong, or let us know so we can improve it!</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_where_to_start">Where To Start?</h3>
<div class="paragraph">
<p>This obviously depends on the type of audience, and also whether you are looking for a Billing System, or a Payment System.</p>
</div>
<div class="paragraph">
<p>If your goal is to get a sense of what Kill Bill provides, and assuming you are at least slightly technical, here is a good start:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Read through the user guides</p>
</li>
<li>
<p><a href="http://killbill.io/downloads/">Download Kill Bill</a> and follow the 5' minutes tutorials from the both the <a href="http://killbill.io/userguide/payments-userguide/">Payment System User Guide</a> and <a href="http://killbill.io/userguide/subscriptions-userguide/">Billing System User Guide</a></p>
</li>
<li>
<p>Gather your requirements and start the prototyping stage. You will need to have a local instance of Kill Bill and you have the following choices:</p>
<div class="ulist">
<ul>
<li>
<p>Use the released war (either self executable) or drop the war into your container</p>
</li>
<li>
<p>Use one of our already built <a href="https://registry.hub.docker.com/u/killbill/killbill">Docker image</a></p>
</li>
<li>
<p>For mode advanced usage, you can also use the source code and rely on the <a href="https://github.com/killbill/killbill/blob/master/bin/start-server">start-server</a> script</p>
</li>
</ul>
</div>
</li>
<li>
<p>Depending on your use case, you will need to configure your catalog, and develop/deploy plugins</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="components-features">Kill Bill Platform Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_multi_tenancy">Multi-Tenancy</h3>
<div class="paragraph">
<p>Kill Bill supports multi-tenancy, meaning you can run multiple logical instances of Kill Bill with a single server and database. This is the default way to deploy Kill Bill.
We posted a <a href="http://killbill.io/blog/subscription-service-using-kill-bill">blog post</a> which illustrates some of the use cases for running Kill Bill in a multi-tenant fashion.</p>
</div>
<div class="paragraph">
<p>When multi-tenancy is enabled, you first need to create a tenant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">curl -v <span class="tok-se">\</span>
     -X POST <span class="tok-se">\</span>
     -u admin:password <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;Content-Type: application/json&#39;</span> <span class="tok-se">\</span>
     -H <span class="tok-s1">&#39;X-Killbill-CreatedBy: admin&#39;</span> <span class="tok-se">\</span>
     -d <span class="tok-s1">&#39;{&quot;apiKey&quot;: &quot;bob&quot;, &quot;apiSecret&quot;: &quot;lazar&quot;}&#39;</span> <span class="tok-se">\</span>
     <span class="tok-s2">&quot;http://127.0.0.1:8080/1.0/kb/tenants&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The call above will create the tenant and that tenant will be identified with its own <code>tenantId</code>. The supplied <code>apiKey</code> needs to be unique across all the tenants. The <code>tenantId</code> is immutable but the <code>apiKey</code> and <code>apiSecret</code> can be updated in the event they are compromised.</p>
</div>
<div class="paragraph">
<p>Each subsequent (REST) api call will require the following two headers (for Kill Bill to identity which tenant that call is targeted to, and verify the user has the right to access that tenant):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>X-Killbill-ApiKey</strong></p>
</li>
<li>
<p><strong>X-Killbill-ApiSecret</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rbac">RBAC</h3>
<div class="paragraph">
<p>Kill Bill&#8217;s authentication and authorization relies on <a href="http://shiro.apache.org/">Apache Shiro</a>.
In a nutshell, Shiro allows you to configure a set of <code>Users</code>, where each <code>User</code> is associated with a set of <code>Roles</code>, and each <code>Role</code> contains a set of <a href="https://github.com/killbill/killbill-api/blob/master/src/main/java/org/killbill/billing/security/Permission.java"><code>Permissions</code></a>.</p>
</div>
<div class="paragraph">
<p>Kill Bill (through Shiro) supports the following types of configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File based configuration (<a href="https://github.com/killbill/killbill/blob/master/profiles/killbill/src/main/resources/shiro.ini">shiro.ini</a>). This is the default configuration embedded in Kill Bill, which provides you with one <code>admin</code> user having all the rights.</p>
</li>
<li>
<p>Database configuration: Kill Bill offers a <a href="https://github.com/killbill/killbill/blob/master/jaxrs/src/main/java/org/killbill/billing/jaxrs/resources/SecurityResource.java">set of endpoints</a> to add users, roles, and permissions</p>
</li>
<li>
<p>LDAP:  Kill Bill also offers to interact with LDAP to retrieve all the users, roles, permissions. The configuration happens though <a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/SecurityConfig.java">system properties</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that all those 3 mechanisms can coexist, and often need to coexist to solve the chicken and egg problem of having permissions to add new users, roles, &#8230;&#8203; through APIs.</p>
</div>
<div class="paragraph">
<p>The following <a href="http://killbill.io/blog/multi-tenancy-authorization/">blog post</a> gives an overview of how our <a href="https://github.com/killbill/killbill-admin-ui">admin UI</a> interacts with Kill Bill and takes advantage of the RBAC features.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plugins">Plugins</h3>
<div class="sect3">
<h4 id="_overview">Overview</h4>
<div class="paragraph">
<p>Kill Bill supports a powerful plugin framework based on the <a href="http://www.osgi.org/Main/HomePage">OSGI standard</a>.
The purpose of OSGI based plugins is to ensure that they are isolated from each other and from the core platform, allowing Kill Bill users to extend the system with minimal knowledge about the system.
Kill Bill supports writing plugins in various languages to address a wider audience of developers, and also leverage existing libraries in other languages than java. In theory, plugins could be written in all JVM based languages. In practice, Kill Bill currently supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java based plugins (pure OSGI plugins)</p>
</li>
<li>
<p>Ruby plugins. They rely on a <a href="https://github.com/killbill/killbill-platform/blob/master/osgi-bundles/bundles/jruby/src/main/java/org/killbill/billing/osgi/bundles/jruby/JRubyActivator.java">built-in framework</a> on top of OSGI to make sure ruby code will be fully isolated. In addition to that, each ruby plugin is based on a <a href="https://github.com/killbill/killbill-plugin-framework-ruby">ruby skeleton</a> whose code is partially <a href="https://github.com/killbill/killbill-java-parser">automatically generated</a> and whose purpose is to allow developers to write pure ruby code.</p>
</li>
<li>
<p>Scala (a prototype has been been built showing the feasibility of such plugins)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The purpose of the plugins is multiple:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provide hooks to third party systems (for e.g: payment gateways, tax systems, fraud detection systems, CRM, proprietary systems, &#8230;&#8203;)</p>
</li>
<li>
<p>Modify the behavior of the core Kill Bill system to address specific needs (for example intercept ongoing payments to route them differently, intercept ongoing invoices to customize them, perform on the fly currency conversion, &#8230;&#8203;)</p>
</li>
<li>
<p>Add specific business logic when certain types of events occur (notify customers of upcoming invoices, perform automatic action for dunning, &#8230;&#8203;)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to achieve those goals, Kill Bill supports a mechanism for the plugin to register for any type of events occurring in the system.
In addition to that, plugins can also implement certain types of <a href="https://github.com/killbill/killbill-plugin-api">plugin apis</a>, and register/unregister in the system during the start/stop sequence.</p>
</div>
<div class="paragraph">
<p>The following set of plugin APIs is currently supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/killbill/killbill-plugin-api/blob/master/payment/src/main/java/org/killbill/billing/payment/plugin/api/PaymentPluginApi.java">Payment plugin api</a>: Those APIs are used by plugins interacting with third party payment gateways or payment processors.</p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill-plugin-api/blob/master/currency/src/main/java/org/killbill/billing/currency/plugin/api/CurrencyPluginApi.java">Currency plugin api</a>: By implementing this API, the plugin would provide the business logic for currency conversion, which is then available to payment plugins for real time currency conversion.</p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill-plugin-api/blob/master/invoice/src/main/java/org/killbill/billing/invoice/plugin/api/InvoicePluginApi.java">Invoice plugin api</a>: Plugins implementing this API would be called during invoice generation when Kill Bill&#8217;s invoicing code computes the items but prior the invoice is persisted, to provide the ability for the plugin to modify the items (for example to add extra tax items).</p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill-plugin-api/blob/master/payment/src/main/java/org/killbill/billing/payment/plugin/api/PaymentPluginApi.java">Payment routing plugin api</a>: The purpose of this API is to intercept payments and as a result abort them (fraud use case) or reroute them to a different payment plugin (payment gateway downtime, or cost optimization scenario).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that some of these APIs are still a work in progress as we understand better the requirements; we are also working on additional plugin APIs to provide access to other parts of the system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_lifecycle_and_layout_internals">Lifecycle and Layout Internals</h4>
<div class="paragraph">
<p>Kill Bill Plugins will be started and stopped during the Kill Bill <a href="https://github.com/killbill/killbill-platform/blob/master/platform-api/src/main/java/org/killbill/billing/platform/api/LifecycleHandlerType.java">lifecycle initialization stages</a>.
Each plugin will need to provide an <a href="https://github.com/killbill/killbill-platform/blob/master/osgi-bundles/libs/killbill/src/main/java/org/killbill/killbill/osgi/libs/killbill/KillbillActivatorBase.java">activator</a> with a <code>start</code> and <code>stop</code> method.
During initialization and when all the foundation and core services have started, Kill Bill will automatically discover the existing plugins (based on the filesystem layout described below) and it will invoke the <code>start</code> method to initialize the plugins.
During shutdown sequence, each plugin will first be stopped and then the rest of the foundation and core services will be stopped.</p>
</div>
<div class="paragraph">
<p>Kill Bill looks for all plugins in a bundle directory, by default <strong>/var/tmp/bundles</strong> (you can override it via the system property <code>org.killbill.osgi.bundle.install.dir</code>).
The expected layout is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>bundles/
  platform/
  plugins/
    ruby/
      ruby-plugin-a/
        ruby-plugin-a-version/
          boot.rb
          killbill.properties
      ruby-plugin-b/
        ruby-plugin-b-version/
          boot.rb
          killbill.properties
    java/
      java-plugin-a/
        java-plugin-a-version/
          plugin-a.jar
      java-plugin-b/
        java-plugin-b-version/
          plugin-b.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>bundles/platform</code> directory is used for non Kill Bill specific OSGI plugins. For example, you can drop in it the <a href="http://felix.apache.org/site/apache-felix-web-console.html">Apache Felix Web Console</a> jar, and Kill Bill will automatically start it during its initialization sequence. <a href="https://github.com/killbill/killbill-platform/tree/master/osgi-bundles/defaultbundles">Here</a> is a recommended set of convenience plugins to run.
Note that in the case of Ruby plugins (see below), you need to copy the correct version of the <code>org.kill-bill.billing:killbill-platform-osgi-bundles-jruby</code> artifact and name it as <code>bundles/platform/jruby.jar</code>.</p>
</div>
<div class="paragraph">
<p>Also, in the case of java based plugins, it is enough to just copy the jar under the correct directory entry, but in the case of the ruby plugins, the layout is a bit more complex: it expects a top level <code>killbill.properties</code> file describing the type of plugin and special libraries to load, as well as a <code>gems</code> directory containing all the dependencies.
Fortunately, if you are using one of the official Ruby plugins, you don&#8217;t need to worry about this. You can download <a href="http://search.maven.org/#search%7Cga%7C1%7Corg.kill-bill.billing.plugin.ruby">tar.gz packages</a> with the correct layout. Simply unpack them and restart Kill Bill.</p>
</div>
<div class="paragraph">
<p>If you want to develop your own ruby plugin, check our instructions <a href="https://github.com/killbill/killbill-plugin-framework-ruby/wiki/Build-Release">here</a> and <a href="https://github.com/killbill/killbill-plugin-framework-ruby/wiki/How-to-vendor-a-plugin-gem-for-Killbill-deployment">here</a>.</p>
</div>
<div class="paragraph">
<p>We also provide hello world skeleton of plugins in <a href="https://github.com/killbill/killbill-hello-world-java-plugin">java</a> and <a href="https://github.com/killbill/killbill-hello-world-ruby-plugin">ruby</a> to get started.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deployment">Deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2">Overview</h3>
<div class="paragraph">
<p>Kill Bill (whether used as a Billing System or Payment System) is fundamentally a backend system and so the following consideration should apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Don&#8217;t make the system visible to the outside world, you should have a front end system, or a reverse proxy in front of it; if you need to handle some IPN (Internal Payment Notification), we also developed an <a href="https://github.com/killbill/killbill-notifications-proxy">app</a> for that specific purpose.</p>
</li>
<li>
<p>Always deploy at least 2 instances (for reliability purpose) in front of a load balancer.</p>
</li>
<li>
<p>Setup your database with a master and a slave instances (or more exotic setup if required), and configure it to take regular snapshot</p>
</li>
<li>
<p>Aggregate your logs (for example using <a href="http://logstash.net/">LogStash</a>, <a href="https://www.graylog.org/">GrayLog2</a>, &#8230;&#8203;) and take a look at our <a href="https://github.com/killbill/killbill/wiki/Logback-recipes">logback recipes</a></p>
</li>
<li>
<p>Look at the all the existing Kill Bill JMX metrics (using VisualVM, jconsole, &#8230;&#8203;) and set some alerts (for instance by using the following <a href="https://github.com/killbill/nagios-jmx-plugin">script</a>)</p>
</li>
<li>
<p>Configure your system properly, especially when it comes to the <a href="https://github.com/killbill/killbill/wiki/Kill-Bill-Bus-and-Notification-Queue-Configuration">settings of the bus and notification queue</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When deploying Kill Bill, the following pieces will need to be deployed in addition to your OS, VM, or container (Docker,&#8230;&#8203;):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A web container (jetty, tomcat, &#8230;&#8203;)</p>
</li>
<li>
<p>The killbill war</p>
</li>
<li>
<p>The plugins</p>
</li>
<li>
<p>The configuration files and system properties</p>
</li>
<li>
<p>The database along with the various schemas: The Kill Bill schema is available from our <a href="http://killbill.io/downloads">download page</a> and each stateful plugin will/should expose such a schema (for example, here is the <a href="https://github.com/killbill/killbill-adyen-plugin/blob/master/src/main/resources/ddl.sql">schema</a> for the Adyen plugin)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to ease the deployment we first created <a href="https://github.com/killbill/killbill-cloud/tree/master/kpm">KPM</a>, the Kill Bill Package Manager.
KPM will allow to fetch existing (signed) artifacts for the main killbill war and also for each of the plugins, and deploy them at the right place.
KPM will <strong>not</strong> take care of deploying the web container and the various configuration files or properties.</p>
</div>
<div class="paragraph">
<p>So, in addition to KPM, we also provide <a href="https://registry.hub.docker.com/u/killbill/killbill">Docker images</a>. Those images internally rely on KPM for fetching the
various artifacts and install them at the right location on the image. The docker <code>run</code> command allows to override existing Kill Bill system properties and mount
volumes where configuration files can be accessed.</p>
</div>
<div class="paragraph">
<p>Note that one can decide to only use KPM for fetching and installing artifacts, and bypass docker to deploy on VMs or bare metal.
Or alternatively one can use other tools, manual steps to fetch those artifacts from <a href="http://search.maven.org/">Maven Central</a>, or by using our convenient <a href="http://killbill.io/downloads">download page</a>.</p>
</div>
<div class="paragraph">
<p>The following sections below will give manual instructions on how to deploy on various containers.</p>
</div>
</div>
<div class="sect2">
<h3 id="deployment-jetty">Installation in Jetty</h3>
<div class="sect3">
<h4 id="_download_the_jetty_container">Download the Jetty container</h4>
<div class="paragraph">
<p>If you don&#8217;t have it yet, you can download the Jetty container <a href="http://download.eclipse.org/jetty/">here</a>. If you&#8217;re unsure which version to use, we recommend <strong>8.1.7.v20120910</strong>. Make sure you can unpack and start Jetty as described <a href="http://wiki.eclipse.org/Jetty/Howto/Install_Jetty">here</a>.</p>
</div>
<div class="paragraph">
<p>Jetty ships with examples you can safely remove:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>contexts/javadoc.xml</p>
</li>
<li>
<p>contexts/test.d/override-web.xml</p>
</li>
<li>
<p>contexts/test.xml</p>
</li>
<li>
<p>webapps/spdy.war</p>
</li>
<li>
<p>webapps/test.war</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_kill_bill_in_jetty">Deploy Kill Bill in Jetty</h4>
<div class="paragraph">
<p>Place the downloaded Kill Bill war under <strong>webapps/root.war</strong> in the Jetty folder.</p>
</div>
<div class="paragraph">
<p>Update the <strong>start.ini</strong> file with Kill Bill specific configuration. Here is a working example (make sure to adapt the jdbc properties):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-err">#</span> <span class="tok-n">Kill</span> <span class="tok-n">Bill</span> <span class="tok-n">properties</span>
<span class="tok-o">-</span><span class="tok-n">Dorg</span><span class="tok-o">.</span><span class="tok-na">killbill</span><span class="tok-o">.</span><span class="tok-na">dao</span><span class="tok-o">.</span><span class="tok-na">url</span><span class="tok-o">=</span><span class="tok-nl">jdbc:mysql:</span><span class="tok-c1">//127.0.0.1:3306/killbill</span>
<span class="tok-o">-</span><span class="tok-n">Dorg</span><span class="tok-o">.</span><span class="tok-na">killbill</span><span class="tok-o">.</span><span class="tok-na">dao</span><span class="tok-o">.</span><span class="tok-na">user</span><span class="tok-o">=</span><span class="tok-n">killbill</span>
<span class="tok-o">-</span><span class="tok-n">Dorg</span><span class="tok-o">.</span><span class="tok-na">killbill</span><span class="tok-o">.</span><span class="tok-na">dao</span><span class="tok-o">.</span><span class="tok-na">password</span><span class="tok-o">=</span><span class="tok-n">killbill</span>

<span class="tok-err">#</span> <span class="tok-n">Start</span> <span class="tok-n">classpath</span> <span class="tok-n">OPTIONS</span>
<span class="tok-n">OPTIONS</span><span class="tok-o">=</span><span class="tok-n">Server</span><span class="tok-o">,</span><span class="tok-n">resources</span><span class="tok-o">,</span><span class="tok-n">ext</span><span class="tok-o">,</span><span class="tok-n">plus</span><span class="tok-o">,</span><span class="tok-n">annotations</span>

<span class="tok-err">#</span> <span class="tok-n">Configuration</span> <span class="tok-n">files</span>
<span class="tok-n">etc</span><span class="tok-o">/</span><span class="tok-n">jetty</span><span class="tok-o">.</span><span class="tok-na">xml</span>
<span class="tok-n">etc</span><span class="tok-o">/</span><span class="tok-n">jetty</span><span class="tok-o">-</span><span class="tok-n">annotations</span><span class="tok-o">.</span><span class="tok-na">xml</span>
<span class="tok-n">etc</span><span class="tok-o">/</span><span class="tok-n">jetty</span><span class="tok-o">-</span><span class="tok-n">deploy</span><span class="tok-o">.</span><span class="tok-na">xml</span>
<span class="tok-n">etc</span><span class="tok-o">/</span><span class="tok-n">jetty</span><span class="tok-o">-</span><span class="tok-n">webapps</span><span class="tok-o">.</span><span class="tok-na">xml</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You should now be all set! Kill Bill can be started via the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">java -jar start.jar</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_enable_ssl">Enable SSL</h4>
<div class="paragraph">
<p>The following command generates a key pair and certificate directly into a keystore:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">keytool -keystore keystore -alias jetty -genkey -keyalg RSA</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save the keystore file under the <strong>etc/</strong> directory of the Jetty distribution.</p>
</div>
<div class="paragraph">
<p>In your <strong>start.ini</strong> file, add the <strong>etc/jetty-ssl.xml</strong> configuration file and edit this file to update the <strong>KeyStorePassword</strong>, <strong>KeyManagerPassword</strong> and <strong>TrustStorePassword</strong> directives with the passwords you specified when you ran the keytool command.</p>
</div>
<div class="paragraph">
<p>Kill Bill should now be available over SSL. For more details, see the Jetty guide <a href="http://wiki.eclipse.org/Jetty/Howto/Configure_SSL">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deployment-tomcat">Installation in Tomcat</h3>
<div class="sect3">
<h4 id="_download_the_tomcat_container">Download the Tomcat container</h4>
<div class="paragraph">
<p>If you don&#8217;t have it yet, you can download the Tomcat container <a href="https://s3.amazonaws.com/kb-binaries/apache-tomcat-7.0.42.tar.gz">here</a>. You can then untar the archive and at this point you need to tweak the configuration before starting it. The setup suggested below is a quick setup used for demo, it may not be not best way to deploy your Kill Bill war into tomcat especially if you plan to have multiple wars within the same container.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_kill_bill_in_tomcat">Deploy Kill Bill in Tomcat</h4>
<div class="paragraph">
<p>Assuming you installed tomcat in a directory called <strong>CATALINA_HOME</strong>, then there are two things that need to happen:</p>
</div>
<div class="paragraph">
<p>The Kill Bill system properties need to be added at the end of the <strong>CATALINA_HOME/conf/catalina.properties</strong>. The minimal set of system properties that need to added are the one for the jdbc parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-err">#</span> <span class="tok-n">Kill</span> <span class="tok-n">Bill</span> <span class="tok-n">properties</span>
<span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">killbill</span><span class="tok-o">.</span><span class="tok-na">dao</span><span class="tok-o">.</span><span class="tok-na">url</span><span class="tok-o">=</span><span class="tok-nl">jdbc:mysql:</span><span class="tok-c1">//127.0.0.1:3306/killbill</span>
<span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">killbill</span><span class="tok-o">.</span><span class="tok-na">dao</span><span class="tok-o">.</span><span class="tok-na">user</span><span class="tok-o">=</span><span class="tok-n">killbill</span>
<span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">killbill</span><span class="tok-o">.</span><span class="tok-na">dao</span><span class="tok-o">.</span><span class="tok-na">password</span><span class="tok-o">=</span><span class="tok-n">killbil</span>
<span class="tok-n">ANTLR_USE_DIRECT_CLASS_LOADING</span><span class="tok-o">=</span><span class="tok-kc">true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A new entry must be added to let tomcat know about the location of the Kill Bill war. That file is called <strong>Root.xml</strong> and it must located under <strong>CATALINA_HOME/conf/Catalina/localhost</strong> (create the directories if they don&#8217;t exist). Its content must be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;Context</span> <span class="tok-na">docBase=</span><span class="tok-s">&quot;path_to_killbill-server.war&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-nt">&lt;/Context&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once this is setup, you can start the tomcat container using the script <strong>CATALINA_HOME/bin/startup.sh</strong>. The server will be started in the background but logs can be followed at <strong>CATALINA_HOME/logs/catalina.out</strong>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deployment-glassfish">Installation in Glassfish</h3>
<div class="sect3">
<h4 id="_download_the_glassfish_container">Download the GlassFish container</h4>
<div class="paragraph">
<p>If you don&#8217;t have it yet, you can download the GlassFish container <a href="http://glassfish.java.net/">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_kill_bill_in_glassfish">Deploy Kill Bill in GlassFish</h4>
<div class="paragraph">
<p>Configure GlassFish with your Kill Bill specific configuration in <strong>domains/domain1/config/domain.xml</strong> (make sure to adapt the jdbc properties):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;jvm-options&gt;</span>-Dorg.killbill.dao.url=jdbc:mysql://127.0.0.1:3306/killbill<span class="tok-nt">&lt;/jvm-options&gt;</span>
<span class="tok-nt">&lt;jvm-options&gt;</span>-Dorg.killbill.dao.user=killbill<span class="tok-nt">&lt;/jvm-options&gt;</span>
<span class="tok-nt">&lt;jvm-options&gt;</span>-Dorg.killbill.dao.password=killbill<span class="tok-nt">&lt;/jvm-options&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <strong>glassfish</strong> directory of the unzipped GlasshFish distribution, run the following command to deploy Kill Bill:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">./bin/asadmin start-domain <span class="tok-p">;</span> ./bin/asadmin deploy --contextroot <span class="tok-s2">&quot;/&quot;</span> /path/to/killbill.war</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration">Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_system_properties">System properties</h3>
<div class="sect3">
<h4 id="configuration-overview">Overview</h4>
<div class="paragraph">
<p>Kill Bill configuration is done principally via Java System Properties. These can be set on the command line (e.g. <code>java -Dkey1=value1 -Dkey2=value2 -jar killbill-server-jetty-console.war</code>) or in Java Properties files (via <code>-Dorg.killbill.server.properties=file:///path/to/killbill.properties</code> or <code>start.ini</code> if you are using Jetty). Some containers use custom formats (for example, System Properties in GlassFish would be placed in <code>domains/domain1/config/domain.xml</code>), so please refer to your container documentation for more information.</p>
</div>
<div class="paragraph">
<p>The system properties are global to the system, and therefore will apply to all tenants. Those properties will also be accessible to the various plugins through a <a href="https://github.com/killbill/killbill-platform/blob/master/osgi-bundles/libs/killbill/src/main/java/org/killbill/killbill/osgi/libs/killbill/OSGIConfigPropertiesService.java">special interface</a>.
Some parts of the system also rely on additional xml configuration. Currently, only the caching layer which is based on <a href="http://ehcache.org/">EhCache</a> requires such <a href="https://github.com/killbill/killbill/blob/master/util/src/main/resources/ehcache.xml">xml configuration</a>. The location of the xml itself is specified via a system property <code>org.killbill.cache.config.location</code>.</p>
</div>
<div class="paragraph">
<p>In addition to these global settings, the following is also available on a per tenant basis:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Catalog configuration</p>
</li>
<li>
<p>Overdue configuration</p>
</li>
<li>
<p>Invoice templates, and language translation resources</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_system_properties_2">System Properties</h4>
<div class="paragraph">
<p>Kill Bill relies on <a href="https://github.com/brianm/config-magic"><code>config-magic</code></a> to define, initialize, and make accessible through function calls all its system properties.</p>
</div>
<div class="paragraph">
<p>Some core services in Kill Bill export some properties, whose name is fairly explanatory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/CatalogConfig.java">Catalog configuration</a> (Only to specify the location of the default catalog if not per-tenant catalog have been uploaded)</p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/InvoiceConfig.java">Invoice configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/PaymentConfig.java">Payment configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/RbacConfig.java">Rbac configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/SecurityConfig.java">Shiro configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/config/CacheConfig.java">Cache configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill/blob/master/util/src/main/java/org/killbill/billing/util/email/EmailConfig.java">SMTP and email configuration for notifications</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties to configure the database are split between the core Kill Bill services and the plugins to allow plugins to use a different database or configuration (pooling, &#8230;&#8203;):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/killbill/killbill-commons/blob/master/jdbi/src/main/java/org/killbill/commons/jdbi/guice/DaoConfig.java">Kill Bill Database configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill-platform/blob/master/osgi/src/main/java/org/killbill/billing/osgi/glue/OSGIDataSourceConfig.java">Plugin   Database configuration</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties to configure the persistent buses and notification queue are shown below. Those properties are built to be used across multiple instances (we have two persistent buses) which explains the substitution parameter <code>instanceName</code>. For more
detail on the configuration of the bus and notification queue, check <a href="https://github.com/killbill/killbill/wiki/Kill-Bill-Bus-and-Notification-Queue-Configuration">here</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/killbill/killbill-commons/blob/master/queue/src/main/java/org/killbill/bus/api/PersistentBusConfig.java">Persistent bus configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill-commons/blob/master/queue/src/main/java/org/killbill/notificationq/api/NotificationQueueConfig.java">Notification queue configuration</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally some high level properties to configure OSGI (where to find the plugins, &#8230;&#8203;), and some Kill Bill web app configuration (multi-tenancy on/off, &#8230;&#8203;):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/killbill/killbill-platform/blob/master/osgi/src/main/java/org/killbill/billing/osgi/config/OSGIConfig.java">OSGI related configuration</a></p>
</li>
<li>
<p><a href="https://github.com/killbill/killbill-platform/blob/master/server/src/main/java/org/killbill/billing/server/config/KillbillServerConfig.java">Kill Bill Web app configuration</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-12-16 01:28:25 UTC
</div>
</div>
</body>
</html>